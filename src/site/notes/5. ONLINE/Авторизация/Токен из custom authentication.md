---
{"dg-publish":true,"permalink":"/5. ONLINE/Авторизация/Токен из custom authentication/","created":"2024-10-30T15:39:43.025-03:00","updated":"2024-10-30T15:40:32.804-03:00"}
---


# Вопрос про токен из custom authentication и использовании его в апи. 

У меня на главной странице (первая после логина) внутри страницы используется listview - API call with infinite scroll (вызов использует authentication token). 
Если пользователь зашёл в приложение, а его токен истек, при вызове апи для этого списка будет неверный токен, то есть 401 ошибка. 

Вопрос: Как лучше сделать проверку на то, что токен не истёк?

Мои идеи:
Если бы это был не инфинит скролл, то я бы повесил апи на событие on page load.

При загрузке страницы можно сделать так?
Проверить current time < token expired time и если нет, то вызвать метод для обновления токена, и потом его отправлять в апи. 
Я боюсь, что он выдаст ошибку

Ответ:
Необходимо добавить обработку ошибок по коду ответа. Таким образом вы сможете вызывать обновление токена в любом случае